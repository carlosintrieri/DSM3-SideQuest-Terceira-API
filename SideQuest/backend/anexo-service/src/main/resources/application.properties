# ====================================
# ANEXO-SERVICE - SIDEQUEST
# ====================================

# Porta e nome da aplicação
server.port=8087
spring.application.name=anexo-service

# ====================================
# MONGODB CONFIGURATION
# ====================================
spring.data.mongodb.uri=mongodb+srv://syntax:fatec123@syntax-bd.vulmuug.mongodb.net/syntaxbd?retryWrites=true&w=majority&appName=syntaxbd
spring.data.mongodb.database=syntaxbd

# ====================================
# DESABILITAR JPA/SQL
# ====================================
spring.autoconfigure.exclude=\
  org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
  org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\
  org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration

# ====================================
# MULTIPART - UPLOAD DE ARQUIVOS
# ====================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=500MB
spring.servlet.multipart.max-request-size=500MB
spring.servlet.multipart.file-size-threshold=100MB

# Evita erro 500/timeout/413
spring.codec.max-in-memory-size=200MB

# Permite upload grande no Tomcat
server.tomcat.max-swallow-size=500MB
server.tomcat.max-http-form-post-size=500MB

# ====================================
# MICROSERVICES URLS (usar API Gateway)
# ====================================
microservices.usuario.url=http://localhost:8081
microservices.projetos.url=http://localhost:8083
microservices.tarefas.url=http://localhost:8084


# ====================================
# JWT CONFIGURATION
# ====================================
jwt.secret=SideQuestSecretKey2024ForJWTAuthenticationAndAuthorizationSystem
jwt.expiration=86400000

# ====================================
# CORS CONFIGURATION
# ====================================
cors.allowed-origins=http://localhost:5173,http://localhost:3000,http://localhost:8080
cors.allowed-methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
cors.allowed-headers=*
cors.allow-credentials=true

# ====================================
# RESILIENCE4J - CIRCUIT BREAKER
# ====================================
resilience4j.circuitbreaker.instances.default.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.default.slidingWindowSize=10
resilience4j.circuitbreaker.instances.default.minimumNumberOfCalls=5
resilience4j.circuitbreaker.instances.default.permittedNumberOfCallsInHalfOpenState=3
resilience4j.circuitbreaker.instances.default.automaticTransitionFromOpenToHalfOpenEnabled=true
resilience4j.circuitbreaker.instances.default.waitDurationInOpenState=5s
resilience4j.circuitbreaker.instances.default.failureRateThreshold=50
resilience4j.circuitbreaker.instances.default.eventConsumerBufferSize=10

# ====================================
# RESILIENCE4J - RATE LIMITER
# ====================================
resilience4j.ratelimiter.instances.default.limitForPeriod=100
resilience4j.ratelimiter.instances.default.limitRefreshPeriod=1s
resilience4j.ratelimiter.instances.default.timeoutDuration=0s

# ====================================
# RESILIENCE4J - RETRY
# ====================================
resilience4j.retry.instances.default.maxAttempts=3
resilience4j.retry.instances.default.waitDuration=500ms

# ====================================
# ACTUATOR - MONITORING
# ====================================
management.endpoints.web.exposure.include=health,info,metrics,circuitbreakers,ratelimiters
management.endpoint.health.show-details=always
management.health.circuitbreakers.enabled=true
management.health.ratelimiters.enabled=true

# ====================================
# SWAGGER/OPENAPI
# ====================================
springdoc.api-docs.enabled=true
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.tagsSorter=alpha
springdoc.packages-to-scan=com.fatec.anexo_service.controller
springdoc.swagger-ui.disable-swagger-default-url=true
springdoc.swagger-ui.server-url=http://localhost:8085
springdoc.swagger-ui.persistAuthorization=true
springdoc.swagger-ui.display-request-duration=true
springdoc.swagger-ui.tryItOutEnabled=true
springdoc.swagger-ui.csrf.enabled=false

# ====================================
# LOGGING
# ====================================
logging.level.root=INFO
logging.level.com.fatec.anexo_service=DEBUG
logging.level.org.springframework=INFO
logging.level.org.springframework.data.mongodb=DEBUG
logging.level.org.mongodb=WARN
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
